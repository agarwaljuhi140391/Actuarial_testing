
#THIS CODE IS AUTO-GENERATED by derivedcomplex_template, DO NOT DIRECTLY EDIT UNLESS YOU KNOW WHAT YOU ARE DOING!

from numba import njit, void, prange
import numpy as np
import math
from numpy import float64, int32, int64

@njit(nogil=True, cache=True)
def HEALTHY_POLICIES(REN_POL_TERM_Y,ANN_TERM_Y,DURATIONIF_M,PREM_WAIVER_IND
		,T,MATURITY_RATE,DEATH_RATE_MONTHLY,LAPSE_RATE_MONTHLY,DECREMENT_WOP_RATES_MONTHLY
		,NO_HTHY_POLS_IFSM,NO_HTHY_DEATHS,NO_HTHY_SURRS,NO_HTHY_WP,NO_HTHY_POLS_IF,NO_HTHY_MATS):
	# NO_HTHY_POLS_IF_start=np.zeros(T.shape[0],dtype=float64)
	for t in range(T.shape[0]):
		if t==0:
			if PREM_WAIVER_IND[0]==1:
				NO_HTHY_POLS_IF_start=0
			else:
				NO_HTHY_POLS_IF_start=1
			NO_HTHY_MATS[t]=NO_HTHY_POLS_IF_start * MATURITY_RATE[t]
			NO_HTHY_POLS_IFSM[t]=NO_HTHY_POLS_IF_start
		else:
			NO_HTHY_MATS[t]=NO_HTHY_POLS_IF[t-1] * MATURITY_RATE[t]
			NO_HTHY_POLS_IFSM[t]=NO_HTHY_POLS_IF[t-1] - NO_HTHY_MATS[t]
			
		NO_HTHY_DEATHS[t]=NO_HTHY_POLS_IFSM[t]*DEATH_RATE_MONTHLY[t]
		NO_HTHY_SURRS[t]=NO_HTHY_POLS_IFSM[t]*(1-DEATH_RATE_MONTHLY[t])*LAPSE_RATE_MONTHLY[t]
		NO_HTHY_WP[t]=(NO_HTHY_POLS_IFSM[t]-NO_HTHY_DEATHS[t]-NO_HTHY_SURRS[t])*DECREMENT_WOP_RATES_MONTHLY[t]
		if T[t]>(REN_POL_TERM_Y[0]+ANN_TERM_Y[0])*12:
			NO_HTHY_POLS_IF[t]=0
		else:
			if T[t]<=DURATIONIF_M[0]:
				NO_HTHY_POLS_IF[t]=NO_HTHY_POLS_IF_start
			else:	
				NO_HTHY_POLS_IF[t]=NO_HTHY_POLS_IFSM[t]-(NO_HTHY_DEATHS[t]+NO_HTHY_SURRS[t]+NO_HTHY_WP[t])


@njit(nogil=True, parallel=True, cache=True)
def wrapped_HEALTHY_POLICIES(REN_POL_TERM_Y,ANN_TERM_Y,DURATIONIF_M,PREM_WAIVER_IND,T,MATURITY_RATE,DEATH_RATE_MONTHLY,LAPSE_RATE_MONTHLY,DECREMENT_WOP_RATES_MONTHLY):
	arr_NO_HTHY_POLS_IFSM=np.zeros(T.shape,float64)
	arr_NO_HTHY_DEATHS=np.zeros(T.shape,float64)
	arr_NO_HTHY_SURRS=np.zeros(T.shape,float64)
	arr_NO_HTHY_WP=np.zeros(T.shape,float64)
	arr_NO_HTHY_POLS_IF=np.zeros(T.shape,float64)
	arr_NO_HTHY_MATS=np.zeros(T.shape,float64)
	for y in prange(T.shape[0]):
		HEALTHY_POLICIES(REN_POL_TERM_Y[y,:],ANN_TERM_Y[y,:],DURATIONIF_M[y,:],PREM_WAIVER_IND[y,:],T[y,:],MATURITY_RATE[y,:],DEATH_RATE_MONTHLY[y,:],LAPSE_RATE_MONTHLY[y,:],DECREMENT_WOP_RATES_MONTHLY[y,:],arr_NO_HTHY_POLS_IFSM[y,:],arr_NO_HTHY_DEATHS[y,:],arr_NO_HTHY_SURRS[y,:],arr_NO_HTHY_WP[y,:],arr_NO_HTHY_POLS_IF[y,:],arr_NO_HTHY_MATS[y,:])
	return {'NO_HTHY_POLS_IFSM': arr_NO_HTHY_POLS_IFSM,'NO_HTHY_DEATHS': arr_NO_HTHY_DEATHS,'NO_HTHY_SURRS': arr_NO_HTHY_SURRS,'NO_HTHY_WP': arr_NO_HTHY_WP,'NO_HTHY_POLS_IF': arr_NO_HTHY_POLS_IF,'NO_HTHY_MATS': arr_NO_HTHY_MATS}
